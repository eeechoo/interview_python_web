# 网络知识

## 1. socket 
### 1.1. 一个端口能够绑定多个 socket
关于一个端口能不能绑定多个socket,
事实证明一个端口可以绑定多个socket。

socket是由 <client ip, client port, server ip, server port> 这个四元组唯一标示的。
``` python
import socket

s = socket.socket()
s.bind(('localhost', 8080))
s.listen(5)
while True:
    conn, address = s.accept()
    print('client address is\n' + str(address))

    # 将两个 socket 打印， 可以看到这两个socket fd 不同，不是同一个socket
    print(conn)
    print(s)

    print('server listen socket is \n' + str(s.getsockname()))
    # 这句话不能要，要了会报错
    # 因为server listen socket 只是监听 server 端口，并不和 client 端口进行链接，
    # 所以 getpeername 会出错
    # print('server listen socket connected to client socket \n' + str(s.getpeername()))
    print('server conn socket is \n' + str(conn.getsockname()))
    print('server conn socket connected to client socket \n' + str(conn.getpeername()))
    conn.close()
    print('************************************************')
```
``` python
# 客户端代码也是可以通过代码模拟的
import socket

s = socket.socket()

# 下面这句放在这里就不行了
#s.getsockname()

s.connect(('localhost', 8080))
print('client socket address is \n' + str(s.getsockname()))

s.close()
```


运行上述代码 server 端打印
```shell
client address is
('127.0.0.1', 49400)
<socket.socket fd=128, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('127.0.0.1', 8082), raddr=('127.0.0.1', 49400)>
<socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('127.0.0.1', 8082)>
server listen socket is 
('127.0.0.1', 8082)
server conn socket is 
('127.0.0.1', 8082)
server conn socket connected to client socket 
('127.0.0.1', 49400)
************************************************
client address is
('127.0.0.1', 56542)
<socket.socket fd=568, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('127.0.0.1', 8082), raddr=('127.0.0.1', 56542)>
<socket.socket fd=12, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('127.0.0.1', 8082)>
server listen socket is 
('127.0.0.1', 8082)
server conn socket is 
('127.0.0.1', 8082)
server conn socket connected to client socket 
('127.0.0.1', 56542)
************************************************
```

运行上述代码 client 端 打印
```shell
client socket address is 
('127.0.0.1', 49400)

client socket address is 
('127.0.0.1', 56542)
```

### 1.2.